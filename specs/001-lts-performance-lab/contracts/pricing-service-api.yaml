openapi: 3.0.3
info:
  title: Pricing Service API
  description: |
    Simple microservice for calculating discounted prices. Used in Module 1 (Runtime & Startup) 
    and Module 5 (Container Deployment) to demonstrate cold-start performance and container optimization.
  version: 1.0.0
  contact:
    name: Dotnet10Workshop
    
servers:
  - url: http://localhost:5000
    description: Local development server

paths:
  /calculate-price:
    post:
      summary: Calculate discounted price
      description: |
        Calculates the final price after applying a percentage discount to an original price.
        Used for runtime performance benchmarking between .NET 8 and .NET 10.
      operationId: calculatePrice
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PriceCalculationRequest'
            examples:
              basicDiscount:
                summary: 20% discount on $100
                value:
                  originalPrice: 100.00
                  discountPercentage: 20.0
              noDiscount:
                summary: No discount applied
                value:
                  originalPrice: 50.00
                  discountPercentage: 0.0
      responses:
        '200':
          description: Successful price calculation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PriceCalculationResponse'
              examples:
                basicDiscount:
                  summary: Result of 20% discount
                  value:
                    originalPrice: 100.00
                    discountPercentage: 20.0
                    discountAmount: 20.00
                    finalPrice: 80.00
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                negativePrice:
                  summary: Negative original price
                  value:
                    error: "Original price must be greater than zero"
                    details: "originalPrice: -10.00"
                invalidPercentage:
                  summary: Invalid discount percentage
                  value:
                    error: "Discount percentage must be between 0 and 100"
                    details: "discountPercentage: 150.0"
                    
  /health:
    get:
      summary: Health check endpoint
      description: Returns service health status for monitoring
      operationId: healthCheck
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    enum: [healthy]
                  timestamp:
                    type: string
                    format: date-time
              example:
                status: healthy
                timestamp: "2025-11-03T10:30:00Z"

components:
  schemas:
    PriceCalculationRequest:
      type: object
      required:
        - originalPrice
        - discountPercentage
      properties:
        originalPrice:
          type: number
          format: double
          minimum: 0.01
          description: Original price before discount (must be > 0)
          example: 100.00
        discountPercentage:
          type: number
          format: double
          minimum: 0
          maximum: 100
          description: Discount percentage to apply (0-100)
          example: 20.0
          
    PriceCalculationResponse:
      type: object
      required:
        - originalPrice
        - discountPercentage
        - discountAmount
        - finalPrice
      properties:
        originalPrice:
          type: number
          format: double
          description: Original price from request
          example: 100.00
        discountPercentage:
          type: number
          format: double
          description: Discount percentage from request
          example: 20.0
        discountAmount:
          type: number
          format: double
          description: Calculated discount amount (originalPrice * discountPercentage / 100)
          example: 20.00
        finalPrice:
          type: number
          format: double
          description: Final price after discount (originalPrice - discountAmount)
          example: 80.00
          
    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          type: string
          description: Human-readable error message
          example: "Invalid request parameters"
        details:
          type: string
          description: Additional error details
          example: "originalPrice: -10.00"

tags:
  - name: Pricing
    description: Price calculation operations
